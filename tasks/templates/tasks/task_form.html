{% extends 'tasks/base.html' %} {% block title %}{% if form.instance.pk %}Update
Task{% else %}Create Task{% endif %}{% endblock %} {% block content %}
<div class="card">
  <div class="card-header bg-primary text-white">
    <!-- Dynamically set the header title -->
    <h2 class="card-title mb-0">
      {% if form.instance.pk %}Update Task{% else %}Create a New Task{% endif %}
    </h2>
  </div>
  <div class="card-body">
    <form method="post">
      <!-- Django security token -->
      {% csrf_token %}

      <!-- Render form fields with Bootstrap styling -->
      <div class="mb-3">
        <label for="{{ form.task_name.id_for_label }}" class="form-label"
          >{{ form.task_name.label }}</label
        >
        {{ form.task_name }}
      </div>
      <div class="mb-3">
        <label for="{{ form.description.id_for_label }}" class="form-label"
          >{{ form.description.label }}</label
        >
        {{ form.description }}
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="{{ form.assigned_to.id_for_label }}" class="form-label"
            >{{ form.assigned_to.label }}</label
          >
          {{ form.assigned_to }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.due_date.id_for_label }}" class="form-label"
            >{{ form.due_date.label }}</label
          >
          {{ form.due_date }}
        </div>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="{{ form.priority.id_for_label }}" class="form-label"
            >{{ form.priority.label }}</label
          >
          {{ form.priority }}
        </div>
        <div class="col-md-6 mb-3">
          <label for="{{ form.status.id_for_label }}" class="form-label"
            >{{ form.status.label }}</label
          >
          {{ form.status }}
        </div>
      </div>

      <div class="text-end">
        <a href="{% url 'task_list' %}" class="btn btn-secondary">Cancel</a>
        <!-- Dynamically set the button text -->
        <button type="submit" class="btn btn-primary">
          {% if form.instance.pk %}Update Task{% else %}Create Task{% endif %}
        </button>
      </div>
    </form>
  </div>
</div>

{% comment %} This script manually adds the 'form-control' class to all input,
textarea, and select elements rendered by the Django form. This ensures they get
proper Bootstrap styling without needing a third-party library like
crispy-forms. {% endcomment %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    form.querySelectorAll("input, textarea, select").forEach(function (field) {
      if (
        field.type !== "checkbox" &&
        field.type !== "radio" &&
        field.type !== "file"
      ) {
        field.classList.add("form-control");
      }
    });
  });
</script>

{% endblock %}
